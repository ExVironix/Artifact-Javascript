!function(e){var t={};function n(a){if(t[a])return t[a].exports;var o=t[a]={i:a,l:!1,exports:{}};return e[a].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(a,o,function(t){return e[t]}.bind(null,o));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";function a(e){return e.replace(/\s/g,"_").replace("'","").toLowerCase()}function o(e){return"number"==typeof e?e:e.reduce((e,t)=>e+t)}n.r(t);let r,s=new Map,d=new Map;function i(e,t){return e=function(){let n=e;return function(){t(),n.apply(this)}}()}s.set("testAbility",function(){console.log("testAbility")}),d.set("Pack Leadership","continuousEffect"),s.set("Pack Leadership",function(e){let t=e.player==H.players[0]?0:1;N.lanes.forEach(function(n){let a=n.cards.findIndex(function(n){return e==n[t]});if(-1!=a)for(var o=-1;o<2;o+=2)null!=n.cards[a+o]&&null!=n.cards[a+o][t].Name&&(n.cards[a+o][t].currentArmor[4]+=1,n.cards[a+o][t].updateDisplay())})}),d.set("Wisdom of the Elders","click"),s.set("Wisdom of the Elders",function(e){console.log("Wisdom of the Elders")}),d.set("Work the Knife","whenAttacking"),s.set("Work the Knife",function(e){}),d.set("Arcane Aura","afterCardPlayed"),s.set("Arcane Aura",function(e){});const l=(e,t)=>{let n=document.createElement("div");return n.classList.add("blank"),null!=e&&(t?e.appendChild(n):e.insertBefore(n,e.firstChild)),{div:n}},c=(e,t)=>{let n="../node_modules/artifactdb/assets",l=document.createElement("div"),c=()=>{},u=()=>{},p=()=>{},f={div:l,player:t};l.classList.add("card",e.Color);let m=a(e.Name),v=document.createElement("IMG");if(v.draggable=!1,v.src=`${n}/artwork/large/${m}.jpg`,l.appendChild(v),"Hero"==e.CardType&&(f.respawn=0,f.Bounty=5),"Creep"==e.CardType&&(f.Bounty=1),"Creep"==e.CardType||"Hero"==e.CardType){f.arrow=0;let t=["left","middle","right"],n=document.createElement("div");n.classList.add("arrow",t[1+f.arrow]),l.appendChild(n),c=i(c,function(){n.classList.remove("left","middle","right"),n.classList.add("arrow",t[1+e.arrow])})}if(null!=e.Health){f.currentHealth=[e.Health,0,0,0,0];let t=document.createElement("div");t.classList.add("icon-container","health");let a=document.createElement("IMG");a.draggable=!1,a.src=`${n}/icon/cardstat-health.png`;let r=document.createElement("div");r.textContent=o(f.currentHealth),t.appendChild(a),t.appendChild(r),l.appendChild(t),c=i(c,function(){r.textContent=o(e.currentHealth)}),u=i(u,function(){e.currentHealth[3]=0}),p=i(p,function(){e.currentHealth[4]=0})}if(null!=e.Attack){f.currentAttack=[e.Attack,0,0,0,0];let t=document.createElement("div");t.classList.add("icon-container","attack");let a=document.createElement("IMG");a.draggable=!1,a.src=`${n}/icon/cardstat-attack.png`;let r=document.createElement("div");r.textContent=e.Attack,t.appendChild(a),t.appendChild(r),l.appendChild(t),c=i(c,function(){r.textContent=o(e.currentAttack)}),u=i(u,function(){e.currentAttack[3]=0}),p=i(p,function(){e.currentAttack[4]=0})}if(null!=e.Armor){f.currentArmor=[e.Armor,0,0,0,0];let t=document.createElement("div");t.classList.add("icon-container","armor");let a=document.createElement("IMG");a.draggable=!1,a.src=`${n}/icon/cardstat-armor.png`;let r=document.createElement("div");r.textContent=e.Armor,t.appendChild(a),t.appendChild(r),l.appendChild(t),c=i(c,function(){r.textContent=o(e.currentArmor)}),u=i(u,function(){e.currentArmor[3]=0}),p=i(p,function(){e.currentArmor[4]=0})}if(null!=e.Abilities){let t=document.createElement("div");t.classList.add("abilities-container"),e.Abilities.forEach(function(o){o.div=document.createElement("div"),o.div.classList.add("ability-container");let r=document.createElement("IMG");r.draggable=!1;let i=a(o.Name);r.src=`${n}/ability/${i}.jpg`,r.title=o.Text,o.div.appendChild(r),t.appendChild(o.div),"Active"==o.Type?o.div.addEventListener("click",function(){s.get(o.Name)(e)}):l.addEventListener(d.get(o.Name),function(){s.get(o.Name)(e)})}),l.appendChild(t)}return l.addEventListener("click",function(){console.log(e)}),l.ondragstart=function(t){r=e,t.dataTransfer.setData("text/plain"," ")},l.addEventListener("endOfRound",u),l.addEventListener("continuousRefresh",p),f.updateDisplay=c,e=Object.assign({},e,f)};var u=(()=>{const e=document.getElementById("zoom-btn"),t=document.getElementById("zoom-btn-left"),n=document.getElementById("zoom-btn-middle"),a=document.getElementById("zoom-btn-right");e.addEventListener("click",function(){N.div.classList.toggle("zoom-out"),H.div.classList.toggle("zoom-out"),N.lanes[H.getCurrentLane()].div.scrollIntoView({inline:"center"})}),t.addEventListener("click",function(){N.div.classList.remove("zoom-out"),H.div.classList.remove("zoom-out"),N.lanes[0].div.scrollIntoView({inline:"center"})}),n.addEventListener("click",function(){N.div.classList.remove("zoom-out"),H.div.classList.remove("zoom-out"),N.lanes[1].div.scrollIntoView({inline:"center"})}),a.addEventListener("click",function(){N.div.classList.remove("zoom-out"),H.div.classList.remove("zoom-out"),N.lanes[2].div.scrollIntoView({inline:"center"})});return{updateActive:()=>{switch(H.getCurrentLane()){case 0:t.classList.add("active"),n.classList.remove("active"),a.classList.remove("active");break;case 1:t.classList.remove("active"),n.classList.add("active"),a.classList.remove("active");break;case 2:t.classList.remove("active"),n.classList.remove("active"),a.classList.add("active")}}}})();var p=(()=>{const e=document.getElementById("pass-btn-bottom"),t=document.getElementById("pass-btn-top"),n=()=>{e.classList.add("display-none"),t.classList.add("display-none")};return n(),setTimeout(function(){e.onclick=H.pass,t.onclick=H.pass},100),{enable:()=>{H.getTurn()?t.disabled=!1:e.disabled=!1,H.getTurn()?e.disabled=!0:t.disabled=!0},disable:()=>{e.disabled=!0,t.disabled=!0},hide:n,show:()=>{e.classList.remove("display-none"),t.classList.remove("display-none")}}})();const f=[],m=document.createElement("button");let v=[];function h(e){e.preventDefault()}function g(e){e.target.classList.add("dragover")}function y(e){e.target.classList.remove("dragover")}function E(){const e=document.createElement("div");e.classList.add("bottom","display-none");const t=document.createElement("div");t.classList.add("top","display-none"),f.push(e),f.push(t),f.forEach(function(e){e.classList.add("stage","UI"),H.div.appendChild(e)}),m.classList.add("deploy-btn","btn","UI","display-none"),m.textContent="Deploy",H.div.appendChild(m),m.addEventListener("click",function(){f[0].hasChildNodes()||f[1].hasChildNodes()?alert("Need to choose lanes for all Heros"):function(){(function(){for(let e=0;e<2;e++)f[e].classList.add("display-none"),N.lanes.forEach(function(t){t.stages[e].classList.add("display-none")})})(),m.classList.add("display-none");for(let e=0;e<3;e++){let t=N.lanes[e];v.forEach(function(n,a){for(;t.cards.reduce(I,[[],[]])[a].length<n[e].length;){let e=Math.random()<.5,n=[l(t.playAreas[0],e),l(t.playAreas[1],e)];e?t.cards.push(n):t.cards.unshift(n)}}),v.forEach(function(n,a){n[e].forEach(function(e){let n=t.cards.reduce(I,[[],[]])[a];n=n[Math.floor(Math.random()*n.length)];let o=t.cards[n][a].div;o.parentNode.replaceChild(e.div,o),t.cards[n][a]=e})})}N.lanes.forEach(function(e){0!=H.getRound()&&e.cards.forEach(function(t,n){t.forEach(function(a,o){if(null!=a.Name){if(null==t[1-o].Name){let t=Math.random();t=t>.75?1:(t>.25)-1,null!=e.cards[n+t]&&null!=e.cards[n+t][1-o].Name||(t=0),a.arrow=t}a.updateDisplay()}})})}),H.dispatchEvent("continuousRefresh"),p.show()}()}),N.lanes.forEach(function(e,t){e.stages.forEach(function(e,n){e.ondragover=h,e.ondragenter=g,e.ondragleave=y,e.ondrop=function(a){a.preventDefault(),y(a),r.player==H.players[n]&&(e.appendChild(r.div),v[n][t].push(r),r.div.draggable=!1)}})})}function L(){v[0]=[[],[],[]],v[1]=[[],[],[]],null==f[0]&&E(),N.div.classList.add("zoom-out"),H.div.classList.add("zoom-out"),function(){for(let e=0;e<2;e++)f[e].classList.remove("display-none"),N.lanes.forEach(function(t){t.stages[e].classList.remove("display-none")})}(),v.forEach(function(e,t){for(let n=0;n<2;n++){let n=Math.floor(3*Math.random()),a=c(w.Cards[132],H.players[t]);e[n].push(a),N.lanes[n].stages[t].appendChild(a.div)}if(0==H.getRound()){let a=function(e){for(let t=e.length-1;t>0;t--){const n=Math.floor(Math.random()*(t+1));[e[t],e[n]]=[e[n],e[t]]}return e}([0,1,2]);for(var n=0;n<3;n++){let o=H.players[t].getHeros()[n];N.lanes[a[n]].stages[t].appendChild(o.div),e[a[n]].push(o)}}H.players[t].getHeros().forEach(function(n){if(0==n.respawn&&0!=H.getRound())if(H.players[t].computer){let a=Math.floor(3*Math.random());e[a].push(n),N.lanes[a].stages[t].appendChild(n.div)}else f[t].appendChild(n.div),n.div.draggable=!0;n.respawn-=1})}),m.classList.remove("display-none")}var C=(()=>{const e=document.getElementById("shop"),t=document.createElement("button");t.innerHTML="Done",t.classList.add("close-btn","btn"),t.type="submit",e.appendChild(t),t.addEventListener("click",function(){e.classList.add("display-none"),L()});return{show:()=>{e.classList.remove("display-none"),t.focus()}}})();var b=()=>{const e=[],t=[document.getElementById("info-bottom"),document.getElementById("info-top")];H.players.forEach(function(n,a){t[a].classList.remove("display-none"),t[a].getElementsByClassName("name")[0].textContent=`${n.name}`,e.push(t[a].getElementsByClassName("gold")[0]),e[a].textContent=n.gold});return{updateDisplay:()=>{H.players.forEach(function(t,n){e[n].textContent=t.gold})}}};n.d(t,"game",function(){return H}),n.d(t,"board",function(){return N}),n.d(t,"cardData",function(){return w}),n.d(t,"posAvail",function(){return I});let w="not loaded yet";!function(e){var t=new XMLHttpRequest;t.overrideMimeType("application/json"),t.open("GET","../node_modules/artifactdb/cards-manifest.json",!0),t.onreadystatechange=function(){4==t.readyState&&"200"==t.status&&e(t.responseText)},t.send(null)}(function(e){w=JSON.parse(e).Sets[0]});const A=(e,t)=>{e=[e];let n=document.createElement("div"),a=!1;let r={currentHealth:e,div:n,Name:"tower",currentArmor:[0],updateDisplay:()=>{o(r.currentHealth)<=0&&(H.score[1-t]+=1,a||(a=!a,r.currentHealth=[80],n.classList.add("ancient"))),n.textContent=o(r.currentHealth)}};return r},k=()=>{let e=A(40,1);return{name:void 0,div:void 0,cards:[],towers:[A(40,0),e],playAreas:[void 0,void 0],stages:[],passCount:0}},N={div:document.getElementById("board"),lanes:[k(),k(),k()]},M=(e,t,n=!1)=>{let a={};setTimeout(function(){(t=t.map(function(e){return c(w.Cards.find(function(t){return t.Name==e}),a)}))[3].respawn=1,t[4].respawn=2},300);return a.getHeros=(()=>t),a.name=e,a.computer=n,a.gold=0,a},H=(()=>{const e=document.getElementById("game");document.getElementById("pass-btn-bottom"),document.getElementById("pass-btn-top");let t,n=[M("Radiant",["Keefe the Bold","Fahrvhan the Dreamer","J'Muy the Wise","Debbi the Cunning","Crystal Maiden"]),M("Dire",["Keefe the Bold","Fahrvhan the Dreamer","J'Muy the Wise","Debbi the Cunning","Crystal Maiden"],!0)],a=0,r=0,s=0,d=[0,0],i=new CustomEvent("afterCombat",{detail:{lane:void 0,card:void 0,player:void 0}}),c=new CustomEvent("endOfRound",{detail:{lane:void 0,card:void 0,player:void 0}}),f=new CustomEvent("continuousRefresh",{detail:{lane:void 0,card:void 0,player:void 0}}),m=new CustomEvent("continuousEffect",{detail:{lane:void 0,card:void 0,player:void 0}});function v(e){let t={afterCombat:e=>{if(e==s)return i},endOfRound:e=>c,continuousRefresh:e=>f,_continuousEffect:e=>m};N.lanes.forEach(function(n,a){n.cards.forEach(function(n,o){n.forEach(function(n,r){if(null!=n.Name){let s=t[e](a);null!=s&&(s.detail.lane=a,s.detail.card=o,s.detail.player=r,n.div.dispatchEvent(s)),n.updateDisplay()}})})}),"continuousRefresh"==e&&v("_continuousEffect")}const h=()=>{N.lanes[s].passCount+=1,N.lanes[s].passCount>1&&(!function(){let e=N.lanes[H.getCurrentLane()];e.cards.forEach(function(t,n){t.forEach(function(t,a){if(null==t.Name)return;let r=e.cards[n+t.arrow][1-a];null==r||null==r.Name?(r=a?e.towers[0]:e.towers[1]).currentHealth[0]-=o(t.currentAttack)-o(r.currentArmor):r.currentHealth[0]-=o(t.currentAttack)-o(r.currentArmor)})}),e.cards.flat().forEach(function(t){null!=t.currentHealth&&o(t.currentHealth)<=0&&function(e,t){let n=t.cards.flat().indexOf(e),a=l();e.div.classList.add("condemned"),e.div.parentNode.replaceChild(a.div,e.div),t.cards[Math.floor(n/2)][n%2]=a,e.player==H.players[0]?H.players[1].gold+=e.Bounty:H.players[0].gold+=e.Bounty,null!=e.respawn&&(e.respawn=1,e.currentHealth[0]=e.Health,e.updateDisplay())}(t,e)}),function e(){let t=!1;N.lanes.forEach(function(e){e.cards.forEach(function(t,n){t.forEach(function(t,a){null!=t.Name&&null==e.cards[n+t.arrow][1-a].Name&&(t.arrow=0)})}),e.cards.forEach(function(n,a){null==n[0].Name&&null==n[1].Name&&(t=!0,n[0].div.parentNode.removeChild(n[0].div),n[1].div.parentNode.removeChild(n[1].div),e.cards.splice(a,1))})}),t?e():H.dispatchEvent("continuousRefresh")}(),e.towers[1].updateDisplay(),e.towers[0].updateDisplay(),H.dispatchEvent("afterCombat"),H.infoDisplayUpdate(),H.gameOver()}(),N.lanes[s].div.classList.remove("active"),(s+=1)>2&&(p.hide(),C.show(),v("endOfRound"),s=0,r+=1),N.lanes[s].div.classList.add("active"),u.updateActive(),N.lanes[s].passCount=0),a=1-a,p.enable(),n[a].computer&&setTimeout(h,300)};return{div:e,getCurrentLane:()=>s,startGame:()=>{console.log("Game Started"),function(){let e=["left-lane","middle-lane","right-lane"],t=["bottom","top"];N.lanes.forEach(function(n,a){n.div=document.createElement("div"),n.name=e[a],n.div.classList.add("lane",e[a]),N.div.appendChild(n.div);for(var a=1;a>=0;a--)n.playAreas[a]=document.createElement("div"),n.playAreas[a].classList.add("playarea",`playarea-${t[a]}`),n.towers[a].div.classList.add("tower",`tower-${t[a]}`),n.towers[a].div.textContent=o(n.towers[a].currentHealth),n.div.appendChild(n.playAreas[a]),n.div.appendChild(n.towers[a].div),n.playAreas[a].addEventListener("scroll",function(){n.playAreas[1-a].scrollLeft=n.playAreas[a].scrollLeft}),n.stages[a]=document.createElement("div"),n.stages[a].classList.add("stage",`stage-${t[a]}`,"display-none"),n.div.appendChild(n.stages[a])})}(),t=b(),N.lanes[s].div.classList.add("active"),L(),p.enable(),u.updateActive()},getRound:()=>r,score:d,gameOver:()=>!(d[0]<2&&d[1]<2||(d[0]>=2&&d[1]>=2?console.log("Tie Game"):d[0]>=2?console.log(`${n[0].name} Wins`):d[1]>=2&&console.log(`${n[1].name} Wins`),p.hide(),0)),getTurn:()=>a,pass:h,players:n,infoDisplayUpdate:()=>{t.updateDisplay()},dispatchEvent:v}})();function I(e,t,n){return null==t[0].Name&&e[0].push(n),null==t[1].Name&&e[1].push(n),e}const B=document.getElementById("start-game-btn");B.disabled=!0;setTimeout(function(){B.disabled=!1},500),B.addEventListener("click",function(){this.parentNode.removeChild(this),H.startGame()})}]);